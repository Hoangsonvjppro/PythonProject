{% extends "base.html" %}

{% block title %}Chat Cộng Đồng{% endblock %}

{% block content %}
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.5/socket.io.js"></script>

    <div class="chat-container">
        <div class="chat-header">Chat Cộng Đồng</div>
        <div class="chat-messages" id="chat-messages"></div>
        <div class="chat-input">
            <input type="text" id="message-input" placeholder="Type your message..." />
            <button id="send-button">Send</button>
        </div>
    </div>

    <script>
        const socket = io();
        const chatMessages = document.getElementById("chat-messages");
        const messageInput = document.getElementById("message-input");
        const sendButton = document.getElementById("send-button");

        sendButton.addEventListener("click", () => {
            const message = messageInput.value.trim();
            if (message) {
                socket.emit("send_message", { message });
                messageInput.value = "";
            }
        });

        socket.on("new_message", (data) => {
            const messageElement = document.createElement("div");
            messageElement.textContent = `${data.username}: ${data.message}`;
            chatMessages.appendChild(messageElement);
        });
    </script>
{% endblock %}
